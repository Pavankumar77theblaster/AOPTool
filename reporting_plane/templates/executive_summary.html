<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Summary - {{ target.name }}</title>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Penetration Test Report</h1>
            <h2>Executive Summary</h2>
            <div class="meta-info">
                <p><strong>Target:</strong> {{ target.name }} ({{ target.url_or_ip }})</p>
                <p><strong>Test Date:</strong> {{ execution.started_at.strftime('%Y-%m-%d') if execution.started_at else 'N/A' }}</p>
                <p><strong>Report Generated:</strong> {{ generated_at }}</p>
                <p><strong>Execution ID:</strong> #{{ execution.id }}</p>
            </div>
        </div>

        <!-- Executive Overview -->
        <div class="section">
            <h2>Executive Overview</h2>
            <p>
                This report presents the findings of a penetration test conducted on <strong>{{ target.name }}</strong>.
                The assessment was performed using automated security testing tools to identify potential vulnerabilities
                and security weaknesses in the target system.
            </p>
            <p>
                The test was conducted over a period of <strong>{{ statistics.duration_formatted }}</strong> and consisted of
                <strong>{{ statistics.total_attacks }}</strong> different attack vectors across multiple security categories.
            </p>
        </div>

        <!-- Key Statistics -->
        <div class="section">
            <h2>Key Statistics</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">{{ statistics.total_findings }}</div>
                    <div class="stat-label">Total Findings</div>
                </div>
                <div class="stat-card critical">
                    <div class="stat-value">{{ statistics.findings_by_severity.critical or 0 }}</div>
                    <div class="stat-label">Critical</div>
                </div>
                <div class="stat-card high">
                    <div class="stat-value">{{ statistics.findings_by_severity.high or 0 }}</div>
                    <div class="stat-label">High</div>
                </div>
                <div class="stat-card medium">
                    <div class="stat-value">{{ statistics.findings_by_severity.medium or 0 }}</div>
                    <div class="stat-label">Medium</div>
                </div>
                <div class="stat-card low">
                    <div class="stat-value">{{ statistics.findings_by_severity.low or 0 }}</div>
                    <div class="stat-label">Low</div>
                </div>
            </div>
        </div>

        <!-- Risk Assessment -->
        <div class="section">
            <h2>Overall Risk Assessment</h2>
            {% set critical_count = statistics.findings_by_severity.critical or 0 %}
            {% set high_count = statistics.findings_by_severity.high or 0 %}

            {% if critical_count > 0 %}
            <div class="risk-assessment critical">
                <h3>CRITICAL RISK</h3>
                <p>
                    The target system has <strong>{{ critical_count }} critical vulnerabilities</strong> that require
                    immediate attention. These vulnerabilities could allow attackers to gain unauthorized access,
                    steal sensitive data, or compromise the entire system.
                </p>
                <p><strong>Recommended Action:</strong> Address critical findings immediately before proceeding with deployment or continued operation.</p>
            </div>
            {% elif high_count > 0 %}
            <div class="risk-assessment high">
                <h3>HIGH RISK</h3>
                <p>
                    The target system has <strong>{{ high_count }} high-severity vulnerabilities</strong> that should
                    be addressed as soon as possible. These vulnerabilities pose significant security risks.
                </p>
                <p><strong>Recommended Action:</strong> Prioritize remediation of high-severity findings within the next sprint.</p>
            </div>
            {% elif statistics.total_findings > 0 %}
            <div class="risk-assessment medium">
                <h3>MODERATE RISK</h3>
                <p>
                    The target system has <strong>{{ statistics.total_findings }} findings</strong> of medium or low severity.
                    While not immediately critical, these should be addressed to improve overall security posture.
                </p>
                <p><strong>Recommended Action:</strong> Plan remediation activities for the next development cycle.</p>
            </div>
            {% else %}
            <div class="risk-assessment low">
                <h3>LOW RISK</h3>
                <p>
                    No significant vulnerabilities were discovered during this assessment. The target system appears to
                    have a solid security posture based on the automated tests conducted.
                </p>
                <p><strong>Recommended Action:</strong> Continue regular security assessments and maintain current security practices.</p>
            </div>
            {% endif %}
        </div>

        <!-- Top Findings -->
        {% if findings %}
        <div class="section">
            <h2>Top Findings Summary</h2>
            <table>
                <thead>
                    <tr>
                        <th>Severity</th>
                        <th>Finding</th>
                        <th>Category</th>
                        <th>CVSS</th>
                    </tr>
                </thead>
                <tbody>
                    {% for finding in findings[:10] %}
                    <tr>
                        <td><span class="severity-{{ finding.risk_level }}">{{ finding.risk_level.upper() }}</span></td>
                        <td>{{ finding.attack_name }}</td>
                        <td>{{ finding.category }}</td>
                        <td>{{ finding.cvss.base_score if finding.cvss else 'N/A' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% if findings|length > 10 %}
            <p class="note">Showing top 10 of {{ findings|length }} total findings. See Technical Report for complete list.</p>
            {% endif %}
        </div>
        {% endif %}

        <!-- Recommendations -->
        <div class="section">
            <h2>Immediate Actions Required</h2>
            <ol>
                {% if statistics.findings_by_severity.critical > 0 %}
                <li><strong>Critical Vulnerabilities:</strong> Review and remediate all {{ statistics.findings_by_severity.critical }} critical findings immediately.</li>
                {% endif %}
                {% if statistics.findings_by_severity.high > 0 %}
                <li><strong>High-Severity Issues:</strong> Plan remediation for {{ statistics.findings_by_severity.high }} high-severity findings within the next sprint.</li>
                {% endif %}
                <li><strong>Review Technical Report:</strong> Consult the detailed technical report for specific remediation guidance.</li>
                <li><strong>Verify Fixes:</strong> Conduct retesting after implementing fixes to ensure vulnerabilities are properly addressed.</li>
                <li><strong>Security Training:</strong> Provide security awareness training to development teams based on findings.</li>
            </ol>
        </div>

        <!-- Charts -->
        {% if charts %}
        <div class="section">
            <h2>Findings Visualization</h2>
            {% if charts.severity_chart %}
            <div class="chart-container">
                <img src="{{ charts.severity_chart }}" alt="Findings by Severity">
            </div>
            {% endif %}
            {% if charts.category_chart %}
            <div class="chart-container">
                <img src="{{ charts.category_chart }}" alt="Findings by Category">
            </div>
            {% endif %}
        </div>
        {% endif %}

        <!-- Footer -->
        <div class="footer">
            <p>Report generated by AOPTool - Autonomous Penetration Testing Platform</p>
            <p>{{ generated_at }}</p>
        </div>
    </div>
</body>
</html>
